{"version":3,"sources":["../src/dom/analyzer.ts","../src/actions/executor.ts","../src/agent/web-agent.ts","../src/agent/langchain-agent.ts","../src/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * DOM Analyzer - Automatically analyzes any webpage and extracts context\n * No configuration needed - works universally on any website\n */\n\nexport interface InteractiveElement {\n  index: number;\n  tagName: string;\n  type: string;\n  role: string;\n  text: string;\n  placeholder?: string;\n  ariaLabel?: string;\n  name?: string;\n  id?: string;\n  className?: string;\n  href?: string;\n  value?: string;\n  isVisible: boolean;\n  isEnabled: boolean;\n  rect: DOMRect;\n  xpath: string;\n  selector: string;\n}\n\nexport interface PageContext {\n  url: string;\n  title: string;\n  description?: string;\n  elements: InteractiveElement[];\n  textContent: string;\n  forms: FormInfo[];\n  tables: TableInfo[];\n  links: LinkInfo[];\n  headings: HeadingInfo[];\n}\n\nexport interface FormInfo {\n  index: number;\n  action?: string;\n  method?: string;\n  fields: FormFieldInfo[];\n}\n\nexport interface FormFieldInfo {\n  name: string;\n  type: string;\n  label?: string;\n  placeholder?: string;\n  required: boolean;\n  elementIndex: number;\n}\n\nexport interface TableInfo {\n  index: number;\n  headers: string[];\n  rowCount: number;\n  caption?: string;\n}\n\nexport interface LinkInfo {\n  text: string;\n  href: string;\n  elementIndex: number;\n}\n\nexport interface HeadingInfo {\n  level: number;\n  text: string;\n}\n\n/**\n * Interactive element selectors - elements users can interact with\n */\nconst INTERACTIVE_SELECTORS = [\n  'a[href]',\n  'button',\n  'input:not([type=\"hidden\"])',\n  'select',\n  'textarea',\n  '[role=\"button\"]',\n  '[role=\"link\"]',\n  '[role=\"menuitem\"]',\n  '[role=\"tab\"]',\n  '[role=\"checkbox\"]',\n  '[role=\"radio\"]',\n  '[role=\"switch\"]',\n  '[role=\"slider\"]',\n  '[role=\"spinbutton\"]',\n  '[role=\"textbox\"]',\n  '[role=\"combobox\"]',\n  '[role=\"listbox\"]',\n  '[role=\"option\"]',\n  '[onclick]',\n  '[tabindex]:not([tabindex=\"-1\"])',\n  '[contenteditable=\"true\"]',\n].join(',');\n\nexport class DOMAnalyzer {\n  private elementCache: Map<number, Element> = new Map();\n  private lastAnalysis: PageContext | null = null;\n\n  /**\n   * Analyze current page and extract all context\n   */\n  analyze(): PageContext {\n    const elements = this.findInteractiveElements();\n    \n    this.lastAnalysis = {\n      url: window.location.href,\n      title: document.title,\n      description: this.getMetaDescription(),\n      elements,\n      textContent: this.getMainTextContent(),\n      forms: this.analyzeForms(elements),\n      tables: this.analyzeTables(),\n      links: this.extractLinks(elements),\n      headings: this.extractHeadings(),\n    };\n\n    return this.lastAnalysis;\n  }\n\n  /**\n   * Get element by index for interaction\n   */\n  getElement(index: number): Element | null {\n    return this.elementCache.get(index) || null;\n  }\n\n  /**\n   * Generate human-readable description of the page state\n   */\n  getStateDescription(): string {\n    const ctx = this.lastAnalysis || this.analyze();\n    \n    let description = `# Page: ${ctx.title}\\nURL: ${ctx.url}\\n\\n`;\n    \n    if (ctx.description) {\n      description += `Description: ${ctx.description}\\n\\n`;\n    }\n\n    // Add headings structure\n    if (ctx.headings.length > 0) {\n      description += `## Page Structure\\n`;\n      ctx.headings.slice(0, 10).forEach(h => {\n        description += `${'  '.repeat(h.level - 1)}- ${h.text}\\n`;\n      });\n      description += '\\n';\n    }\n\n    // Add forms\n    if (ctx.forms.length > 0) {\n      description += `## Forms (${ctx.forms.length})\\n`;\n      ctx.forms.forEach((form, i) => {\n        description += `Form ${i + 1}:\\n`;\n        form.fields.forEach(field => {\n          const required = field.required ? ' (required)' : '';\n          description += `  - [${field.elementIndex}] ${field.label || field.name || field.type}${required}\\n`;\n        });\n      });\n      description += '\\n';\n    }\n\n    // Add interactive elements\n    description += `## Interactive Elements (${ctx.elements.length})\\n`;\n    ctx.elements.slice(0, 50).forEach(el => {\n      const label = el.ariaLabel || el.text || el.placeholder || el.name || el.tagName;\n      const truncated = label.length > 50 ? label.substring(0, 47) + '...' : label;\n      description += `[${el.index}] ${el.type}: ${truncated}\\n`;\n    });\n\n    if (ctx.elements.length > 50) {\n      description += `... and ${ctx.elements.length - 50} more elements\\n`;\n    }\n\n    return description;\n  }\n\n  /**\n   * Find all interactive elements on the page\n   */\n  private findInteractiveElements(): InteractiveElement[] {\n    this.elementCache.clear();\n    const elements: InteractiveElement[] = [];\n    const seen = new Set<Element>();\n    \n    document.querySelectorAll(INTERACTIVE_SELECTORS).forEach((el) => {\n      if (seen.has(el)) return;\n      seen.add(el);\n\n      // Skip hidden elements\n      const rect = el.getBoundingClientRect();\n      const style = window.getComputedStyle(el);\n      const isVisible = rect.width > 0 && \n                       rect.height > 0 && \n                       style.visibility !== 'hidden' && \n                       style.display !== 'none' &&\n                       style.opacity !== '0';\n\n      if (!isVisible) return;\n\n      const index = elements.length;\n      this.elementCache.set(index, el);\n\n      elements.push({\n        index,\n        tagName: el.tagName.toLowerCase(),\n        type: this.getElementType(el),\n        role: el.getAttribute('role') || this.inferRole(el),\n        text: this.getElementText(el),\n        placeholder: (el as HTMLInputElement).placeholder,\n        ariaLabel: el.getAttribute('aria-label') || undefined,\n        name: (el as HTMLInputElement).name || undefined,\n        id: el.id || undefined,\n        className: el.className || undefined,\n        href: (el as HTMLAnchorElement).href || undefined,\n        value: (el as HTMLInputElement).value || undefined,\n        isVisible: true,\n        isEnabled: !(el as HTMLInputElement).disabled,\n        rect,\n        xpath: this.getXPath(el),\n        selector: this.getUniqueSelector(el),\n      });\n    });\n\n    return elements;\n  }\n\n  private getElementType(el: Element): string {\n    const tag = el.tagName.toLowerCase();\n    if (tag === 'input') {\n      return `input[${(el as HTMLInputElement).type}]`;\n    }\n    if (tag === 'a') return 'link';\n    if (tag === 'button') return 'button';\n    if (tag === 'select') return 'dropdown';\n    if (tag === 'textarea') return 'textarea';\n    return el.getAttribute('role') || tag;\n  }\n\n  private inferRole(el: Element): string {\n    const tag = el.tagName.toLowerCase();\n    if (tag === 'a') return 'link';\n    if (tag === 'button') return 'button';\n    if (tag === 'input') {\n      const type = (el as HTMLInputElement).type;\n      if (type === 'submit' || type === 'button') return 'button';\n      if (type === 'checkbox') return 'checkbox';\n      if (type === 'radio') return 'radio';\n      return 'textbox';\n    }\n    if (tag === 'select') return 'combobox';\n    if (tag === 'textarea') return 'textbox';\n    return 'generic';\n  }\n\n  private getElementText(el: Element): string {\n    // Try aria-label first\n    const ariaLabel = el.getAttribute('aria-label');\n    if (ariaLabel) return ariaLabel;\n\n    // Try inner text\n    const text = el.textContent?.trim();\n    if (text && text.length < 100) return text;\n\n    // Try value for inputs\n    const value = (el as HTMLInputElement).value;\n    if (value) return value;\n\n    // Try placeholder\n    const placeholder = (el as HTMLInputElement).placeholder;\n    if (placeholder) return placeholder;\n\n    // Try title\n    const title = el.getAttribute('title');\n    if (title) return title;\n\n    return el.tagName.toLowerCase();\n  }\n\n  private getXPath(el: Element): string {\n    const parts: string[] = [];\n    let current: Element | null = el;\n\n    while (current && current !== document.body) {\n      let index = 1;\n      let sibling = current.previousElementSibling;\n      \n      while (sibling) {\n        if (sibling.tagName === current.tagName) index++;\n        sibling = sibling.previousElementSibling;\n      }\n\n      const tag = current.tagName.toLowerCase();\n      parts.unshift(`${tag}[${index}]`);\n      current = current.parentElement;\n    }\n\n    return '//' + parts.join('/');\n  }\n\n  private getUniqueSelector(el: Element): string {\n    if (el.id) return `#${el.id}`;\n    \n    const tag = el.tagName.toLowerCase();\n    const classes = Array.from(el.classList).slice(0, 2).join('.');\n    \n    if (classes) {\n      const selector = `${tag}.${classes}`;\n      if (document.querySelectorAll(selector).length === 1) {\n        return selector;\n      }\n    }\n\n    // Fallback to nth-child\n    const parent = el.parentElement;\n    if (parent) {\n      const siblings = Array.from(parent.children);\n      const index = siblings.indexOf(el) + 1;\n      return `${this.getUniqueSelector(parent)} > ${tag}:nth-child(${index})`;\n    }\n\n    return tag;\n  }\n\n  private getMetaDescription(): string | undefined {\n    const meta = document.querySelector('meta[name=\"description\"]');\n    return meta?.getAttribute('content') || undefined;\n  }\n\n  private getMainTextContent(): string {\n    // Try to get main content area\n    const main = document.querySelector('main, article, [role=\"main\"], .content, #content');\n    if (main) {\n      return main.textContent?.trim().substring(0, 2000) || '';\n    }\n    return document.body.textContent?.trim().substring(0, 2000) || '';\n  }\n\n  private analyzeForms(elements: InteractiveElement[]): FormInfo[] {\n    const forms: FormInfo[] = [];\n    \n    document.querySelectorAll('form').forEach((form, index) => {\n      const fields: FormFieldInfo[] = [];\n      \n      form.querySelectorAll('input, select, textarea').forEach((field) => {\n        const el = field as HTMLInputElement;\n        if (el.type === 'hidden') return;\n\n        // Find associated label\n        let label = '';\n        if (el.id) {\n          const labelEl = document.querySelector(`label[for=\"${el.id}\"]`);\n          label = labelEl?.textContent?.trim() || '';\n        }\n        if (!label && el.parentElement?.tagName === 'LABEL') {\n          label = el.parentElement.textContent?.trim() || '';\n        }\n\n        // Find element index\n        const elementIndex = elements.findIndex(e => \n          this.elementCache.get(e.index) === field\n        );\n\n        fields.push({\n          name: el.name || el.id || '',\n          type: el.type || el.tagName.toLowerCase(),\n          label: label || undefined,\n          placeholder: el.placeholder || undefined,\n          required: el.required || el.hasAttribute('aria-required'),\n          elementIndex,\n        });\n      });\n\n      forms.push({\n        index,\n        action: form.action || undefined,\n        method: form.method || undefined,\n        fields,\n      });\n    });\n\n    return forms;\n  }\n\n  private analyzeTables(): TableInfo[] {\n    const tables: TableInfo[] = [];\n    \n    document.querySelectorAll('table').forEach((table, index) => {\n      const headers: string[] = [];\n      table.querySelectorAll('th').forEach(th => {\n        headers.push(th.textContent?.trim() || '');\n      });\n\n      const caption = table.querySelector('caption')?.textContent?.trim();\n      const rowCount = table.querySelectorAll('tr').length;\n\n      tables.push({ index, headers, rowCount, caption });\n    });\n\n    return tables;\n  }\n\n  private extractLinks(elements: InteractiveElement[]): LinkInfo[] {\n    return elements\n      .filter(el => el.tagName === 'a' && el.href)\n      .map(el => ({\n        text: el.text,\n        href: el.href!,\n        elementIndex: el.index,\n      }));\n  }\n\n  private extractHeadings(): HeadingInfo[] {\n    const headings: HeadingInfo[] = [];\n    document.querySelectorAll('h1, h2, h3, h4, h5, h6').forEach(h => {\n      const level = parseInt(h.tagName[1]);\n      const text = h.textContent?.trim() || '';\n      if (text) {\n        headings.push({ level, text });\n      }\n    });\n    return headings;\n  }\n}\n","/**\n * Action Executor - Performs actions on any webpage\n * Automatically handles clicks, typing, scrolling, navigation\n */\n\nimport type { DOMAnalyzer, InteractiveElement } from '../dom/analyzer';\n\nexport type ActionType = \n  | 'click'\n  | 'type'\n  | 'clear'\n  | 'select'\n  | 'scroll'\n  | 'hover'\n  | 'focus'\n  | 'wait'\n  | 'navigate'\n  | 'goBack'\n  | 'goForward'\n  | 'refresh'\n  | 'done';\n\nexport interface ActionParams {\n  click: { index: number };\n  type: { index: number; text: string; clear?: boolean };\n  clear: { index: number };\n  select: { index: number; value: string };\n  scroll: { direction: 'up' | 'down' | 'left' | 'right'; amount?: number };\n  hover: { index: number };\n  focus: { index: number };\n  wait: { ms: number };\n  navigate: { url: string };\n  goBack: Record<string, never>;\n  goForward: Record<string, never>;\n  refresh: Record<string, never>;\n  done: { reasoning?: string };\n}\n\nexport interface ActionResult {\n  success: boolean;\n  action: ActionType;\n  message: string;\n  error?: string;\n  elementInfo?: Partial<InteractiveElement>;\n}\n\nexport class ActionExecutor {\n  constructor(private analyzer: DOMAnalyzer) {}\n\n  async execute<T extends ActionType>(\n    action: T,\n    params: ActionParams[T]\n  ): Promise<ActionResult> {\n    try {\n      switch (action) {\n        case 'click':\n          return await this.click((params as ActionParams['click']).index);\n        case 'type':\n          const typeParams = params as ActionParams['type'];\n          return await this.type(typeParams.index, typeParams.text, typeParams.clear);\n        case 'clear':\n          return await this.clear((params as ActionParams['clear']).index);\n        case 'select':\n          const selectParams = params as ActionParams['select'];\n          return await this.select(selectParams.index, selectParams.value);\n        case 'scroll':\n          const scrollParams = params as ActionParams['scroll'];\n          return this.scroll(scrollParams.direction, scrollParams.amount);\n        case 'hover':\n          return await this.hover((params as ActionParams['hover']).index);\n        case 'focus':\n          return await this.focus((params as ActionParams['focus']).index);\n        case 'wait':\n          return await this.wait((params as ActionParams['wait']).ms);\n        case 'navigate':\n          return this.navigate((params as ActionParams['navigate']).url);\n        case 'goBack':\n          return this.goBack();\n        case 'goForward':\n          return this.goForward();\n        case 'refresh':\n          return this.refresh();\n        default:\n          return { success: false, action, message: `Unknown action: ${action}` };\n      }\n    } catch (error) {\n      return {\n        success: false,\n        action,\n        message: `Action failed: ${action}`,\n        error: error instanceof Error ? error.message : String(error),\n      };\n    }\n  }\n\n  private async click(index: number): Promise<ActionResult> {\n    const element = this.analyzer.getElement(index) as HTMLElement;\n    if (!element) {\n      return { success: false, action: 'click', message: `Element [${index}] not found` };\n    }\n\n    // Scroll into view\n    element.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    await this.delay(100);\n\n    // Focus and click\n    element.focus();\n    element.click();\n\n    // Dispatch events for better compatibility\n    element.dispatchEvent(new MouseEvent('mousedown', { bubbles: true }));\n    element.dispatchEvent(new MouseEvent('mouseup', { bubbles: true }));\n    element.dispatchEvent(new MouseEvent('click', { bubbles: true }));\n\n    return {\n      success: true,\n      action: 'click',\n      message: `Clicked element [${index}]`,\n      elementInfo: { index, text: element.textContent?.trim().substring(0, 50) },\n    };\n  }\n\n  private async type(index: number, text: string, clear = true): Promise<ActionResult> {\n    const element = this.analyzer.getElement(index) as HTMLInputElement | HTMLTextAreaElement;\n    if (!element) {\n      return { success: false, action: 'type', message: `Element [${index}] not found` };\n    }\n\n    element.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    await this.delay(50);\n    element.focus();\n\n    if (clear) {\n      element.value = '';\n      element.dispatchEvent(new Event('input', { bubbles: true }));\n    }\n\n    // Type character by character for better compatibility\n    for (const char of text) {\n      element.value += char;\n      element.dispatchEvent(new KeyboardEvent('keydown', { key: char, bubbles: true }));\n      element.dispatchEvent(new KeyboardEvent('keypress', { key: char, bubbles: true }));\n      element.dispatchEvent(new Event('input', { bubbles: true }));\n      element.dispatchEvent(new KeyboardEvent('keyup', { key: char, bubbles: true }));\n      await this.delay(10);\n    }\n\n    element.dispatchEvent(new Event('change', { bubbles: true }));\n\n    return {\n      success: true,\n      action: 'type',\n      message: `Typed \"${text.substring(0, 30)}${text.length > 30 ? '...' : ''}\" into element [${index}]`,\n      elementInfo: { index },\n    };\n  }\n\n  private async clear(index: number): Promise<ActionResult> {\n    const element = this.analyzer.getElement(index) as HTMLInputElement;\n    if (!element) {\n      return { success: false, action: 'clear', message: `Element [${index}] not found` };\n    }\n\n    element.focus();\n    element.value = '';\n    element.dispatchEvent(new Event('input', { bubbles: true }));\n    element.dispatchEvent(new Event('change', { bubbles: true }));\n\n    return { success: true, action: 'clear', message: `Cleared element [${index}]` };\n  }\n\n  private async select(index: number, value: string): Promise<ActionResult> {\n    const element = this.analyzer.getElement(index) as HTMLSelectElement;\n    if (!element) {\n      return { success: false, action: 'select', message: `Element [${index}] not found` };\n    }\n\n    element.value = value;\n    element.dispatchEvent(new Event('change', { bubbles: true }));\n\n    return {\n      success: true,\n      action: 'select',\n      message: `Selected \"${value}\" in element [${index}]`,\n    };\n  }\n\n  private scroll(direction: 'up' | 'down' | 'left' | 'right', amount = 300): ActionResult {\n    const scrollOptions: ScrollToOptions = { behavior: 'smooth' };\n    \n    switch (direction) {\n      case 'up':\n        window.scrollBy({ ...scrollOptions, top: -amount });\n        break;\n      case 'down':\n        window.scrollBy({ ...scrollOptions, top: amount });\n        break;\n      case 'left':\n        window.scrollBy({ ...scrollOptions, left: -amount });\n        break;\n      case 'right':\n        window.scrollBy({ ...scrollOptions, left: amount });\n        break;\n    }\n\n    return { success: true, action: 'scroll', message: `Scrolled ${direction} by ${amount}px` };\n  }\n\n  private async hover(index: number): Promise<ActionResult> {\n    const element = this.analyzer.getElement(index) as HTMLElement;\n    if (!element) {\n      return { success: false, action: 'hover', message: `Element [${index}] not found` };\n    }\n\n    element.dispatchEvent(new MouseEvent('mouseenter', { bubbles: true }));\n    element.dispatchEvent(new MouseEvent('mouseover', { bubbles: true }));\n\n    return { success: true, action: 'hover', message: `Hovered over element [${index}]` };\n  }\n\n  private async focus(index: number): Promise<ActionResult> {\n    const element = this.analyzer.getElement(index) as HTMLElement;\n    if (!element) {\n      return { success: false, action: 'focus', message: `Element [${index}] not found` };\n    }\n\n    element.focus();\n    return { success: true, action: 'focus', message: `Focused element [${index}]` };\n  }\n\n  private async wait(ms: number): Promise<ActionResult> {\n    await this.delay(ms);\n    return { success: true, action: 'wait', message: `Waited ${ms}ms` };\n  }\n\n  private navigate(url: string): ActionResult {\n    window.location.href = url;\n    return { success: true, action: 'navigate', message: `Navigating to ${url}` };\n  }\n\n  private goBack(): ActionResult {\n    window.history.back();\n    return { success: true, action: 'goBack', message: 'Navigated back' };\n  }\n\n  private goForward(): ActionResult {\n    window.history.forward();\n    return { success: true, action: 'goForward', message: 'Navigated forward' };\n  }\n\n  private refresh(): ActionResult {\n    window.location.reload();\n    return { success: true, action: 'refresh', message: 'Page refreshed' };\n  }\n\n  private delay(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n}\n","/**\n * WebAgent - Universal AI agent that works on any webpage\n * Just import and use - no configuration needed\n */\n\nimport { DOMAnalyzer, type PageContext } from '../dom/analyzer';\nimport { ActionExecutor, type ActionType, type ActionParams, type ActionResult } from '../actions/executor';\n\nexport interface WebAgentConfig {\n  /** LLM API endpoint */\n  apiEndpoint?: string;\n  /** API key for authentication */\n  apiKey?: string;\n  /** Model to use (e.g., 'gpt-4', 'claude-3', 'gemini-pro') */\n  model?: string;\n  /** Custom system prompt */\n  systemPrompt?: string;\n  /** Enable debug mode */\n  debug?: boolean;\n  /** Callback when agent performs action */\n  onAction?: (action: ActionType, params: unknown, result: ActionResult) => void;\n  /** Callback when agent thinks */\n  onThink?: (thought: string) => void;\n  /** Callback when agent gets page context */\n  onContext?: (context: PageContext) => void;\n}\n\nexport interface ChatMessage {\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n}\n\nexport interface AgentAction {\n  action: ActionType;\n  params: Record<string, unknown>;\n  reasoning: string;\n}\n\nconst DEFAULT_SYSTEM_PROMPT = `You are a helpful AI assistant that can interact with web pages.\nYou analyze the page context and perform actions to help the user accomplish their goals.\n\nWhen given a task, you should:\n1. Analyze the current page state\n2. Decide what action to take\n3. Return the action in JSON format\n\nAvailable actions:\n- click: { \"action\": \"click\", \"params\": { \"index\": <element_index> }, \"reasoning\": \"why\" }\n- type: { \"action\": \"type\", \"params\": { \"index\": <element_index>, \"text\": \"...\" }, \"reasoning\": \"why\" }\n- select: { \"action\": \"select\", \"params\": { \"index\": <element_index>, \"value\": \"...\" }, \"reasoning\": \"why\" }\n- scroll: { \"action\": \"scroll\", \"params\": { \"direction\": \"up|down\" }, \"reasoning\": \"why\" }\n- wait: { \"action\": \"wait\", \"params\": { \"ms\": 1000 }, \"reasoning\": \"why\" }\n- done: { \"action\": \"done\", \"reasoning\": \"task completed because...\" }\n\nAlways respond with valid JSON. Use element indices from the page context.`;\n\nexport class WebAgent {\n  private analyzer: DOMAnalyzer;\n  private executor: ActionExecutor;\n  private config: WebAgentConfig;\n  private history: ChatMessage[] = [];\n  private isRunning = false;\n\n  constructor(config: WebAgentConfig = {}) {\n    this.config = {\n      model: 'gpt-4',\n      debug: false,\n      ...config,\n    };\n    this.analyzer = new DOMAnalyzer();\n    this.executor = new ActionExecutor(this.analyzer);\n  }\n\n  /**\n   * Chat with the agent - it will analyze the page and respond\n   */\n  async chat(message: string): Promise<string> {\n    // Add user message\n    this.history.push({ role: 'user', content: message });\n\n    // Analyze current page\n    const context = this.analyzer.analyze();\n    this.config.onContext?.(context);\n\n    // Build prompt with page context\n    const stateDescription = this.analyzer.getStateDescription();\n    const prompt = `Current page state:\\n${stateDescription}\\n\\nUser request: ${message}`;\n\n    // Get LLM response\n    const response = await this.callLLM(prompt);\n    \n    // Add assistant response\n    this.history.push({ role: 'assistant', content: response });\n\n    return response;\n  }\n\n  /**\n   * Execute a task automatically - agent will perform actions until done\n   */\n  async execute(task: string, maxSteps = 10): Promise<ActionResult[]> {\n    if (this.isRunning) {\n      throw new Error('Agent is already running');\n    }\n\n    this.isRunning = true;\n    const results: ActionResult[] = [];\n\n    try {\n      for (let step = 0; step < maxSteps; step++) {\n        // Analyze page\n        const context = this.analyzer.analyze();\n        this.config.onContext?.(context);\n\n        // Get next action from LLM\n        const stateDescription = this.analyzer.getStateDescription();\n        const prompt = step === 0\n          ? `Task: ${task}\\n\\nCurrent page:\\n${stateDescription}\\n\\nWhat action should I take first?`\n          : `Task: ${task}\\n\\nCurrent page:\\n${stateDescription}\\n\\nPrevious actions: ${results.map(r => r.message).join(', ')}\\n\\nWhat action should I take next?`;\n\n        const response = await this.callLLM(prompt);\n        this.config.onThink?.(response);\n\n        // Parse action from response\n        const action = this.parseAction(response);\n        \n        if (!action) {\n          this.log('Could not parse action from response');\n          break;\n        }\n\n        if (action.action === 'done') {\n          this.log('Task completed: ' + action.reasoning);\n          break;\n        }\n\n        // Execute action\n        const result = await this.executor.execute(\n          action.action as ActionType,\n          action.params as ActionParams[ActionType]\n        );\n        \n        results.push(result);\n        this.config.onAction?.(action.action as ActionType, action.params, result);\n        this.log(`Action: ${result.message}`);\n\n        // Wait for page to update\n        await this.delay(500);\n      }\n    } finally {\n      this.isRunning = false;\n    }\n\n    return results;\n  }\n\n  /**\n   * Perform a single action\n   */\n  async act<T extends ActionType>(action: T, params: ActionParams[T]): Promise<ActionResult> {\n    const result = await this.executor.execute(action, params);\n    this.config.onAction?.(action, params, result);\n    return result;\n  }\n\n  /**\n   * Get current page context\n   */\n  getContext(): PageContext {\n    return this.analyzer.analyze();\n  }\n\n  /**\n   * Get human-readable page description\n   */\n  getPageDescription(): string {\n    return this.analyzer.getStateDescription();\n  }\n\n  /**\n   * Stop current execution\n   */\n  stop(): void {\n    this.isRunning = false;\n  }\n\n  /**\n   * Clear chat history\n   */\n  clearHistory(): void {\n    this.history = [];\n  }\n\n  private async callLLM(prompt: string): Promise<string> {\n    // If no API endpoint, return mock response for testing\n    if (!this.config.apiEndpoint || !this.config.apiKey) {\n      return this.mockLLMResponse(prompt);\n    }\n\n    const messages = [\n      { role: 'system', content: this.config.systemPrompt || DEFAULT_SYSTEM_PROMPT },\n      ...this.history,\n      { role: 'user', content: prompt },\n    ];\n\n    try {\n      const response = await fetch(this.config.apiEndpoint, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${this.config.apiKey}`,\n        },\n        body: JSON.stringify({\n          model: this.config.model,\n          messages,\n          temperature: 0.7,\n        }),\n      });\n\n      const data = await response.json();\n      return data.choices?.[0]?.message?.content || 'No response';\n    } catch (error) {\n      this.log('LLM API error: ' + (error instanceof Error ? error.message : error));\n      throw error;\n    }\n  }\n\n  private mockLLMResponse(prompt: string): string {\n    // Simple mock for testing without API\n    const lowerPrompt = prompt.toLowerCase();\n    \n    if (lowerPrompt.includes('click') && lowerPrompt.includes('button')) {\n      return '{\"action\": \"click\", \"params\": {\"index\": 0}, \"reasoning\": \"Clicking the first button\"}';\n    }\n    if (lowerPrompt.includes('search') || lowerPrompt.includes('type')) {\n      return '{\"action\": \"type\", \"params\": {\"index\": 0, \"text\": \"test\"}, \"reasoning\": \"Typing in search field\"}';\n    }\n    if (lowerPrompt.includes('scroll')) {\n      return '{\"action\": \"scroll\", \"params\": {\"direction\": \"down\"}, \"reasoning\": \"Scrolling to see more content\"}';\n    }\n    \n    return '{\"action\": \"done\", \"reasoning\": \"I analyzed the page. What would you like me to do?\"}';\n  }\n\n  private parseAction(response: string): AgentAction | null {\n    try {\n      // Try to extract JSON from response\n      const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        return JSON.parse(jsonMatch[0]);\n      }\n    } catch {\n      this.log('Failed to parse action JSON');\n    }\n    return null;\n  }\n\n  private log(message: string): void {\n    if (this.config.debug) {\n      console.log(`[WebAgent] ${message}`);\n    }\n  }\n\n  private delay(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n}\n","/**\n * LangChainWebAgent - Web Agent built on top of LangChain.js\n * Uses structured output with Zod schema to ensure consistent action format\n */\n\nimport { z } from 'zod';\nimport { DOMAnalyzer, type PageContext } from '../dom/analyzer';\nimport { ActionExecutor, type ActionType, type ActionParams, type ActionResult } from '../actions/executor';\n\n// ============== Zod Schemas for Structured Output ==============\n\n/**\n * Schema for click action\n */\nexport const ClickActionSchema = z.object({\n  action: z.literal('click'),\n  index: z.number().describe('The index of the element to click'),\n  reasoning: z.string().describe('Why this action is being performed'),\n});\n\n/**\n * Schema for type/input action\n */\nexport const TypeActionSchema = z.object({\n  action: z.literal('type'),\n  index: z.number().describe('The index of the input element'),\n  text: z.string().describe('The text to type into the element'),\n  reasoning: z.string().describe('Why this action is being performed'),\n});\n\n/**\n * Schema for select dropdown action\n */\nexport const SelectActionSchema = z.object({\n  action: z.literal('select'),\n  index: z.number().describe('The index of the select element'),\n  value: z.string().describe('The value to select'),\n  reasoning: z.string().describe('Why this action is being performed'),\n});\n\n/**\n * Schema for scroll action\n */\nexport const ScrollActionSchema = z.object({\n  action: z.literal('scroll'),\n  direction: z.enum(['up', 'down']).describe('Direction to scroll'),\n  reasoning: z.string().describe('Why this action is being performed'),\n});\n\n/**\n * Schema for wait action\n */\nexport const WaitActionSchema = z.object({\n  action: z.literal('wait'),\n  ms: z.number().default(1000).describe('Milliseconds to wait'),\n  reasoning: z.string().describe('Why this action is being performed'),\n});\n\n/**\n * Schema for done/complete action\n */\nexport const DoneActionSchema = z.object({\n  action: z.literal('done'),\n  reasoning: z.string().describe('Why the task is considered complete'),\n});\n\n/**\n * Union schema for all possible actions - LLM must output one of these\n */\nexport const WebActionSchema = z.discriminatedUnion('action', [\n  ClickActionSchema,\n  TypeActionSchema,\n  SelectActionSchema,\n  ScrollActionSchema,\n  WaitActionSchema,\n  DoneActionSchema,\n]);\n\n/**\n * Schema for multiple actions (for form filling, etc.)\n */\nexport const WebActionsListSchema = z.object({\n  actions: z.array(WebActionSchema).describe('List of actions to perform in order'),\n  summary: z.string().describe('Brief summary of what these actions will accomplish'),\n});\n\n// Export types\nexport type WebAction = z.infer<typeof WebActionSchema>;\nexport type WebActionsList = z.infer<typeof WebActionsListSchema>;\nexport type ClickAction = z.infer<typeof ClickActionSchema>;\nexport type TypeAction = z.infer<typeof TypeActionSchema>;\nexport type SelectAction = z.infer<typeof SelectActionSchema>;\nexport type ScrollAction = z.infer<typeof ScrollActionSchema>;\nexport type WaitAction = z.infer<typeof WaitActionSchema>;\nexport type DoneAction = z.infer<typeof DoneActionSchema>;\n\n// ============== LangChain Integration ==============\n\nexport interface LangChainConfig {\n  /**\n   * LangChain chat model instance \n   * Pass in ChatOpenAI, ChatAnthropic, ChatGoogleGenerativeAI, etc.\n   */\n  model?: unknown; // BaseChatModel from @langchain/core\n  \n  /**\n   * Or use simple API config (will create ChatOpenAI internally)\n   */\n  apiEndpoint?: string;\n  apiKey?: string;\n  modelName?: string;\n  \n  /**\n   * Enable debug logging\n   */\n  debug?: boolean;\n  \n  /**\n   * Callback when action is executed\n   */\n  onAction?: (action: WebAction, result: ActionResult) => void;\n  \n  /**\n   * Callback when thinking/reasoning\n   */\n  onThink?: (thought: string) => void;\n  \n  /**\n   * Callback for page context updates\n   */\n  onContext?: (context: PageContext) => void;\n  \n  /**\n   * Max retries for parsing\n   */\n  maxRetries?: number;\n}\n\n/**\n * System prompt optimized for structured output\n */\nconst STRUCTURED_SYSTEM_PROMPT = `You are a Web Agent AI assistant. Your job is to interact with web pages by outputting structured actions.\n\nCRITICAL: You MUST respond with valid JSON that matches the expected schema.\n\nPAGE ELEMENTS are identified by their [index] number. Use this index in your actions.\n\nAVAILABLE ACTIONS:\n1. click - Click on an element\n   {\"action\": \"click\", \"index\": 0, \"reasoning\": \"...\"}\n\n2. type - Enter text into an input field  \n   {\"action\": \"type\", \"index\": 0, \"text\": \"Hello\", \"reasoning\": \"...\"}\n\n3. select - Choose option in a dropdown\n   {\"action\": \"select\", \"index\": 0, \"value\": \"option1\", \"reasoning\": \"...\"}\n\n4. scroll - Scroll the page\n   {\"action\": \"scroll\", \"direction\": \"down\", \"reasoning\": \"...\"}\n\n5. wait - Wait for something to load\n   {\"action\": \"wait\", \"ms\": 1000, \"reasoning\": \"...\"}\n\n6. done - Task is complete\n   {\"action\": \"done\", \"reasoning\": \"...\"}\n\nFor MULTIPLE ACTIONS (like filling a form), respond with:\n{\n  \"actions\": [\n    {\"action\": \"type\", \"index\": 0, \"text\": \"John\", \"reasoning\": \"Fill name field\"},\n    {\"action\": \"type\", \"index\": 1, \"text\": \"john@email.com\", \"reasoning\": \"Fill email\"},\n    {\"action\": \"click\", \"index\": 2, \"reasoning\": \"Submit form\"}\n  ],\n  \"summary\": \"Fill and submit the contact form\"\n}\n\nRULES:\n- Always use element index from the page context\n- Always include reasoning for your actions\n- Output valid JSON only - no markdown, no explanation text outside JSON`;\n\n/**\n * LangChain-powered Web Agent with structured output\n */\nexport class LangChainWebAgent {\n  private analyzer: DOMAnalyzer;\n  private executor: ActionExecutor;\n  private config: LangChainConfig;\n  private chatModel: unknown; // Will be typed when LangChain is available\n  \n  constructor(config: LangChainConfig = {}) {\n    this.config = {\n      debug: false,\n      maxRetries: 3,\n      ...config,\n    };\n    this.analyzer = new DOMAnalyzer();\n    this.executor = new ActionExecutor(this.analyzer);\n    this.chatModel = config.model;\n  }\n\n  /**\n   * Set the LangChain chat model\n   * Use this if you want to configure the model separately\n   */\n  setModel(model: unknown): void {\n    this.chatModel = model;\n  }\n\n  /**\n   * Get current page context\n   */\n  getContext(): PageContext {\n    const context = this.analyzer.analyze();\n    this.config.onContext?.(context);\n    return context;\n  }\n\n  /**\n   * Get page description for LLM\n   */\n  getPageDescription(): string {\n    return this.analyzer.getStateDescription();\n  }\n\n  /**\n   * Execute a single action\n   */\n  async executeAction(action: WebAction): Promise<ActionResult> {\n    let result: ActionResult;\n    \n    switch (action.action) {\n      case 'click':\n        result = await this.executor.execute('click', { index: action.index });\n        break;\n      case 'type':\n        result = await this.executor.execute('type', { index: action.index, text: action.text });\n        break;\n      case 'select':\n        result = await this.executor.execute('select', { index: action.index, value: action.value });\n        break;\n      case 'scroll':\n        result = await this.executor.execute('scroll', { direction: action.direction });\n        break;\n      case 'wait':\n        await new Promise(r => setTimeout(r, action.ms || 1000));\n        result = { success: true, action: 'wait', message: `Waited ${action.ms || 1000}ms` };\n        break;\n      case 'done':\n        result = { success: true, action: 'done', message: action.reasoning };\n        break;\n      default:\n        result = { success: false, action: 'wait', message: 'Unknown action' };\n    }\n\n    this.config.onAction?.(action, result);\n    this.log(`Action: ${action.action} - ${result.message}`);\n    \n    return result;\n  }\n\n  /**\n   * Execute multiple actions in sequence\n   */\n  async executeActions(actions: WebAction[]): Promise<ActionResult[]> {\n    const results: ActionResult[] = [];\n    \n    for (const action of actions) {\n      const result = await this.executeAction(action);\n      results.push(result);\n      \n      if (!result.success || action.action === 'done') {\n        break;\n      }\n      \n      // Small delay between actions\n      await new Promise(r => setTimeout(r, 300));\n    }\n    \n    return results;\n  }\n\n  /**\n   * Chat with the agent using LangChain model\n   * Requires @langchain/core to be installed\n   */\n  async chat(message: string): Promise<{ response: string; actions?: WebAction[] }> {\n    const pageContext = this.getPageDescription();\n    \n    // If using LangChain model with structured output\n    if (this.chatModel) {\n      return this.chatWithLangChain(message, pageContext);\n    }\n    \n    // Fallback to simple API call\n    return this.chatWithAPI(message, pageContext);\n  }\n\n  /**\n   * Execute a task automatically using LangChain\n   */\n  async execute(task: string, maxSteps = 10): Promise<ActionResult[]> {\n    const allResults: ActionResult[] = [];\n    \n    for (let step = 0; step < maxSteps; step++) {\n      const { actions } = await this.chat(\n        step === 0 \n          ? `Task: ${task}` \n          : `Continue task: ${task}\\nPrevious results: ${allResults.map(r => r.message).join(', ')}`\n      );\n      \n      if (!actions || actions.length === 0) {\n        this.log('No actions returned');\n        break;\n      }\n      \n      const results = await this.executeActions(actions);\n      allResults.push(...results);\n      \n      // Check if done\n      const doneAction = actions.find(a => a.action === 'done');\n      if (doneAction) {\n        this.log(`Task complete: ${doneAction.reasoning}`);\n        break;\n      }\n      \n      // Wait for page updates\n      await new Promise(r => setTimeout(r, 500));\n    }\n    \n    return allResults;\n  }\n\n  /**\n   * Chat using LangChain model with structured output\n   */\n  private async chatWithLangChain(message: string, pageContext: string): Promise<{ response: string; actions?: WebAction[] }> {\n    try {\n      // Dynamic import to support optional LangChain\n      const model = this.chatModel as {\n        withStructuredOutput?: (schema: unknown) => unknown;\n        invoke?: (messages: unknown[]) => Promise<{ content: string }>;\n      };\n      \n      // Try structured output if available\n      if (model?.withStructuredOutput) {\n        const structuredModel = model.withStructuredOutput(WebActionsListSchema);\n        const response = await (structuredModel as { invoke: (messages: unknown[]) => Promise<WebActionsList> }).invoke([\n          { role: 'system', content: STRUCTURED_SYSTEM_PROMPT },\n          { role: 'user', content: `${pageContext}\\n\\nUser request: ${message}` },\n        ]);\n        \n        return {\n          response: response.summary,\n          actions: response.actions,\n        };\n      }\n      \n      // Fallback to regular invoke and parse\n      if (model?.invoke) {\n        const response = await model.invoke([\n          { role: 'system', content: STRUCTURED_SYSTEM_PROMPT },\n          { role: 'user', content: `${pageContext}\\n\\nUser request: ${message}` },\n        ]);\n        \n        const parsed = this.parseActionsFromResponse(response.content);\n        return {\n          response: parsed.summary || response.content,\n          actions: parsed.actions,\n        };\n      }\n    } catch (error) {\n      this.log(`LangChain error: ${error}`);\n    }\n    \n    return { response: 'LangChain model not properly configured' };\n  }\n\n  /**\n   * Simple API call fallback\n   */\n  private async chatWithAPI(message: string, pageContext: string): Promise<{ response: string; actions?: WebAction[] }> {\n    if (!this.config.apiEndpoint || !this.config.apiKey) {\n      return this.mockResponse(message);\n    }\n\n    try {\n      const response = await fetch(this.config.apiEndpoint, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${this.config.apiKey}`,\n        },\n        body: JSON.stringify({\n          model: this.config.modelName || 'gpt-4',\n          messages: [\n            { role: 'system', content: STRUCTURED_SYSTEM_PROMPT },\n            { role: 'user', content: `${pageContext}\\n\\nUser request: ${message}` },\n          ],\n          temperature: 0.3,\n          response_format: { type: 'json_object' },\n        }),\n      });\n\n      const data = await response.json();\n      const content = data.choices?.[0]?.message?.content || '';\n      \n      const parsed = this.parseActionsFromResponse(content);\n      return {\n        response: parsed.summary || content,\n        actions: parsed.actions,\n      };\n    } catch (error) {\n      this.log(`API error: ${error}`);\n      return { response: `Error: ${error}` };\n    }\n  }\n\n  /**\n   * Parse actions from LLM response text\n   */\n  private parseActionsFromResponse(response: string): { summary?: string; actions?: WebAction[] } {\n    for (let retry = 0; retry < (this.config.maxRetries || 3); retry++) {\n      try {\n        // Try to find JSON in response\n        const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n        if (!jsonMatch) continue;\n        \n        const parsed = JSON.parse(jsonMatch[0]);\n        \n        // Check if it's an actions list\n        if (parsed.actions && Array.isArray(parsed.actions)) {\n          const validated = WebActionsListSchema.safeParse(parsed);\n          if (validated.success) {\n            return validated.data;\n          }\n        }\n        \n        // Check if it's a single action\n        const singleValidated = WebActionSchema.safeParse(parsed);\n        if (singleValidated.success) {\n          return { \n            summary: singleValidated.data.reasoning,\n            actions: [singleValidated.data] \n          };\n        }\n        \n      } catch (e) {\n        this.log(`Parse attempt ${retry + 1} failed`);\n      }\n    }\n    \n    return {};\n  }\n\n  /**\n   * Mock response for testing without API\n   */\n  private mockResponse(message: string): { response: string; actions?: WebAction[] } {\n    const lower = message.toLowerCase();\n    \n    if (lower.includes('in form') || lower.includes('fill form')) {\n      return {\n        response: 'in form vi thng tin test',\n        actions: [\n          { action: 'type', index: 0, text: 'Nguyn Vn A', reasoning: 'in h tn' },\n          { action: 'type', index: 1, text: 'test@example.com', reasoning: 'in email' },\n          { action: 'type', index: 2, text: '0901234567', reasoning: 'in ST' },\n          { action: 'select', index: 3, value: 'support', reasoning: 'Chn ch ' },\n          { action: 'type', index: 4, text: 'Tin nhn test', reasoning: 'in ni dung' },\n        ],\n      };\n    }\n    \n    if (lower.includes('click') || lower.includes('submit') || lower.includes('gi')) {\n      return {\n        response: 'Click vo nt',\n        actions: [{ action: 'click', index: 5, reasoning: 'Click submit button' }],\n      };\n    }\n    \n    return {\n      response: 'Phn tch trang thnh cng',\n      actions: [{ action: 'done', reasoning: ' phn tch xong trang web' }],\n    };\n  }\n\n  private log(message: string): void {\n    if (this.config.debug) {\n      console.log(`[LangChainWebAgent] ${message}`);\n    }\n    this.config.onThink?.(message);\n  }\n}\n\n// ============== Factory Functions ==============\n\n/**\n * Create agent with OpenAI model\n * Requires @langchain/openai to be installed: npm i @langchain/openai\n */\nexport async function createOpenAIAgent(apiKey: string, modelName = 'gpt-4'): Promise<LangChainWebAgent> {\n  try {\n    // @ts-ignore - Optional dependency, users need to install @langchain/openai\n    const { ChatOpenAI } = await import('@langchain/openai');\n    const model = new ChatOpenAI({ \n      apiKey, \n      modelName,\n      temperature: 0.3,\n    });\n    return new LangChainWebAgent({ model, debug: true });\n  } catch {\n    console.warn('@langchain/openai not installed, using API fallback');\n    return new LangChainWebAgent({\n      apiEndpoint: 'https://api.openai.com/v1/chat/completions',\n      apiKey,\n      modelName,\n      debug: true,\n    });\n  }\n}\n\n/**\n * Create agent with Anthropic Claude model\n * Requires @langchain/anthropic to be installed: npm i @langchain/anthropic\n */\nexport async function createAnthropicAgent(apiKey: string, modelName = 'claude-3-sonnet-20240229'): Promise<LangChainWebAgent> {\n  try {\n    // @ts-ignore - Optional dependency, users need to install @langchain/anthropic\n    const { ChatAnthropic } = await import('@langchain/anthropic');\n    const model = new ChatAnthropic({ \n      apiKey, \n      modelName,\n      temperature: 0.3,\n    });\n    return new LangChainWebAgent({ model, debug: true });\n  } catch {\n    console.warn('@langchain/anthropic not installed');\n    return new LangChainWebAgent({ debug: true });\n  }\n}\n\n/**\n * Create agent with Google Gemini model\n * Requires @langchain/google-genai to be installed: npm i @langchain/google-genai\n */\nexport async function createGeminiAgent(apiKey: string, modelName = 'gemini-pro'): Promise<LangChainWebAgent> {\n  try {\n    // @ts-ignore - Optional dependency, users need to install @langchain/google-genai\n    const { ChatGoogleGenerativeAI } = await import('@langchain/google-genai');\n    const model = new ChatGoogleGenerativeAI({ \n      apiKey, \n      modelName,\n      temperature: 0.3,\n    });\n    return new LangChainWebAgent({ model, debug: true });\n  } catch {\n    console.warn('@langchain/google-genai not installed');\n    return new LangChainWebAgent({ debug: true });\n  }\n}\n\n/**\n * Create agent with custom OpenAI-compatible API (like MISA AI)\n */\nexport function createCustomAgent(config: {\n  apiEndpoint: string;\n  apiKey: string;\n  modelName?: string;\n}): LangChainWebAgent {\n  return new LangChainWebAgent({\n    apiEndpoint: config.apiEndpoint,\n    apiKey: config.apiKey,\n    modelName: config.modelName,\n    debug: true,\n  });\n}\n","/**\n * web-agent-sdk - Universal Web Agent SDK\n * AI-powered browser automation that works on any webpage\n * \n * @example\n * ```typescript\n * import { WebAgent } from 'web-agent-sdk';\n * \n * const agent = new WebAgent({\n *   apiKey: 'your-api-key',\n *   apiEndpoint: 'https://api.openai.com/v1/chat/completions'\n * });\n * \n * // Chat with the agent\n * const response = await agent.chat('What can you see on this page?');\n * \n * // Or execute a task automatically\n * await agent.execute('Fill out the contact form with my info');\n * ```\n */\n\n// Core exports\nexport { WebAgent, type WebAgentConfig, type ChatMessage, type AgentAction } from './agent/web-agent';\n\n// DOM Analysis\nexport { DOMAnalyzer, type PageContext, type InteractiveElement, type FormInfo, type TableInfo, type LinkInfo, type HeadingInfo } from './dom/analyzer';\n\n// Actions\nexport { ActionExecutor, type ActionType, type ActionParams, type ActionResult } from './actions/executor';\n\n// LangChain Agent with Structured Output\nexport {\n  LangChainWebAgent,\n  type LangChainConfig,\n  type WebAction,\n  type WebActionsList,\n  // Zod Schemas for validation\n  WebActionSchema,\n  WebActionsListSchema,\n  ClickActionSchema,\n  TypeActionSchema,\n  SelectActionSchema,\n  ScrollActionSchema,\n  WaitActionSchema,\n  DoneActionSchema,\n  // Factory functions\n  createOpenAIAgent,\n  createAnthropicAgent,\n  createGeminiAgent,\n  createCustomAgent,\n} from './agent/langchain-agent';\n\n// Re-export WebAgent as default\nimport { WebAgent } from './agent/web-agent';\nexport default WebAgent;\n"]}